<!DOCTYPE html>
<html>
  <head>
    <title>Knob Test</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <script type="text/javascript" src="../../../Utilities/Utilities.js"></script>
    <script type="text/javascript" src="../../Element.js"></script>
    <script type="text/javascript" src="../../UI.js"></script>
    <script type="text/javascript" src="../../Knob.js"></script>
    <script type="text/javascript" src="../../wrappers/CanvasDraw.js"></script>
  </head>
  <body>
    <canvas id="plugin" width="200" height="200"></canvas>
    <script type="text/javascript">

        // This should fix "console not defined" problem.
        if (typeof console=="undefined"){console={log:function(A){var B=false;if(B){alert(A)}}}}
        var ui;

        /* INIT */

        var plugin_canvas = document.getElementById("plugin");
        var plugin_context = plugin_canvas.getContext("2d");

        ui = new UI (plugin_canvas);

        var imageDisplayer = new CanvasDrawImage (plugin_context);


        // Knob
        function knob_name (basename, knob_n) {
            // Not general
            if (knob_n < 10) {
                knob_n = "0" + knob_n ;
            }
            var name = basename + knob_n;
            return name;
        }

        //This is the array of image names
        var medknob_img_array = [];

        // Number of medium knob image frames.
        var medium_knobs_images = 39;

        var images_location = "../images/"

        //Generate all the medium knob image names
        for (i = 0; i <= medium_knobs_images; i++) {
            var filename = images_location + knob_name ("knob_med_", i + 1) + ".png";
            medknob_img_array[i] = filename;
        }

        var dummyvar = new loadImageArray (medknob_img_array, imagesCompleted);

        function imagesCompleted (imagesArrayReturned) {

            var knobArgs = {
                imagesArray : imagesArrayReturned,
                sensivity : 2000
            };

            knobArgs.onValueSet = function () {
                var that = this;
                return function (slot, value) {
                    console.log ("onValueSet callback: slot is ", slot, " and value is ", value, " while that is ", that);
                };
            }();

            var knob = new Knob("test_knob", [90, 90], knobArgs);
            // Shouldn't a knob be clickable by default? TODO
            knob.setClickable(true);

            ui.addElement(knob, imageDisplayer);

            knob.setValue("knobvalue", 0.7);
        }


    </script>
  </body>
</html>
